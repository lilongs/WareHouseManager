using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;

namespace DALayer
{
    public class DAInsertSupplier
    {
        Sqlconn mySqlconn = new Sqlconn();
        /// <summary>
        /// 新增供应商信息
        /// </summary>
        /// <param name="SupplierID"></param>
        /// <param name="Name"></param>
        /// <param name="Address"></param>
        /// <param name="Phone"></param>
        /// <param name="Fax"></param>
        /// <param name="PostalCode"></param>
        /// <param name="ConstactPerson"></param>
        /// <returns></returns>
        public int InsertSupplier(string SupplierID , string Name,string Address,string Phone,string Fax,
                                    string PostalCode,string ConstactPerson)
        {
            string Sql = string.Empty;
            string str = string.Empty;
            str = "select * from  Supplier where SupplierID='" + SupplierID + "'";
            DataSet myDs = new DataSet();
            myDs = mySqlconn.Query(str);
            if (myDs.Tables[0].Rows.Count > 0)
            {
                return -1;      //返回-1，Supplier表中已存在该SupplierID
            }
            else
            {
                Sql = "insert into Supplier (SupplierID ,Name,Address,Phone,Fax,PostalCode,ConstactPerson,CreateDate)values('" + SupplierID + "','" + Name + "','" + Address + "','" + Phone + "','" + Fax + "','" + PostalCode + "','" + ConstactPerson + "', '" + DateTime.Now.ToString("yyyy-MM-dd") + "')";
                int i = mySqlconn.ExecuteNonQuery(Sql);
                return i;
            }
        }
    }
}
