using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;

namespace DALayer
{
    public class DAProductListAdd
    {

        string SQL = string.Empty;//保持SQL语句
        Sqlconn mysqlconn = new Sqlconn();
        public int ProductAdd(string paramProductID, string paramProductClassID, string paramProductName, string paramProductSpec , string paramUnitID, string paramEmployeeName, string paramRemark)
        {
            int returnValue = 0;
            string strSql = "INSERT INTO ProductList(ProductID,ProductClassID,ProductName,ProductSpec,ProductUnitID,EmployeeName,Remark,CreateDate) Values ('" + paramProductID + "', '" + paramProductClassID + "','" + paramProductName + "','" + paramProductSpec + "','" + paramUnitID + "','" + paramEmployeeName + "','" + paramRemark + "','" + DateTime.Now.ToString("yyyy-MM-dd") + "')";
            returnValue = mysqlconn.ExeNonQuery(strSql);
            return returnValue;
            
        }

        /// <summary>
        /// 模糊查询物料信息
        /// </summary>
        /// <param name="paramItemName"></param>
        /// <returns></returns>
        public DataTable GetItemInfo(string paramItemName)
        {
            DataTable myDt = new DataTable();
            try
            {
                SQL = @"select ProductID,ProductName, ProductClassName from ProductList
                        left join  ProductClass  on  ProductClass.ProductClassID=ProductList.ProductClassID 
                        where ProductName like '%" + paramItemName + "%'";
            DataSet myDs = new DataSet();
            myDs = mysqlconn.Query(SQL);
            myDt = myDs.Tables[0];
            return myDt;
            }
            catch 
            {
                return myDt;
               
            }
        }
    }
}
